# üìã Django ModelForm with Bootstrap 5 & Complete Validation

---

## üéØ Complete Django ModelForm Implementation Guide

This guide covers creating Django ModelForms with Bootstrap 5 styling, form validation, and database operations following best practices.

---

## üìÅ Project Structure Overview

```
first_app/
‚îú‚îÄ‚îÄ models.py       # Database models
‚îú‚îÄ‚îÄ forms.py        # ModelForm definitions
‚îú‚îÄ‚îÄ views.py        # View handlers
‚îú‚îÄ‚îÄ urls.py         # URL routing
‚îî‚îÄ‚îÄ templates/
    ‚îî‚îÄ‚îÄ first_app/
        ‚îú‚îÄ‚îÄ student_form.html  # Form template
        ‚îî‚îÄ‚îÄ index.html         # List template
```

---

## ‚öôÔ∏è Step 1: Create Model
### üìÑ `first_app/models.py`

```python
from django.db import models

# Create your models here.

class Student(models.Model):
    # id=models.AutoField(primary_key=True) #this line django takes automatically
    first_name = models.CharField(max_length=100)
    last_name = models.CharField(max_length=100)
    email = models.EmailField(unique=True)
    phone = models.CharField(max_length=15)
    date_of_birth = models.DateField()
    
    # Gender choices
    GENDER_CHOICES = (
        ('M', 'Male'),
        ('F', 'Female'),
        ('O', 'Other'),
    )
    gender = models.CharField(max_length=1, choices=GENDER_CHOICES)
    
    # Course choices  
    COURSE_CHOICES = (
        ('Python', 'Python Programming'),
        ('Django', 'Django Framework'),
        ('React', 'React JS'),
        ('ML', 'Machine Learning'),
    )
    course = models.CharField(max_length=10, choices=COURSE_CHOICES)
    
    address = models.TextField()
    enrollment_date = models.DateTimeField(auto_now_add=True)
    is_active = models.BooleanField(default=True)
    
    # Show the object representation
    def __str__(self):
        return f"{self.first_name} {self.last_name} - {self.course}"
```

### üìù Model Fields Explained:
- **CharField**: Text field with max length
- **EmailField**: Email validation built-in
- **DateField**: Date picker field
- **TextField**: Multi-line text input
- **BooleanField**: Checkbox (True/False)
- **Choices**: Dropdown/Radio options
- **auto_now_add**: Auto-set on creation

---

## üìù Step 2: Create ModelForm
### üìÑ `first_app/forms.py`

```python
from django import forms
from first_app.models import Student
from django.core import validators

class StudentForm(forms.ModelForm):
    # Additional field for confirmation email (not in model)
    confirm_email = forms.EmailField(
        label="Confirm Email",
        widget=forms.EmailInput(attrs={
            'class': 'form-control',
            'placeholder': 'Confirm your email'
        })
    )
    
    class Meta:
        model = Student
        fields = '__all__'  # Include all fields from model
        # fields = ['first_name', 'last_name', 'email']  # Select specific fields
        # exclude = ['enrollment_date', 'is_active']  # Exclude specific fields
        
        # Custom labels
        labels = {
            'first_name': 'First Name',
            'last_name': 'Last Name', 
            'date_of_birth': 'Birth Date',
        }
        
        # Bootstrap 5 styling for all fields
        widgets = {
            'first_name': forms.TextInput(attrs={
                'class': 'form-control',
                'placeholder': 'Enter your first name'
            }),
            'last_name': forms.TextInput(attrs={
                'class': 'form-control',
                'placeholder': 'Enter your last name'
            }),
            'email': forms.EmailInput(attrs={
                'class': 'form-control',
                'placeholder': 'example@email.com'
            }),
            'phone': forms.TextInput(attrs={
                'class': 'form-control',
                'placeholder': '+880 1XXX-XXXXXX',
                'pattern': '[0-9+()-]+'
            }),
            'date_of_birth': forms.DateInput(attrs={
                'class': 'form-control',
                'type': 'date'
            }),
            'gender': forms.RadioSelect(attrs={
                'class': 'form-check-input'
            }),
            'course': forms.Select(attrs={
                'class': 'form-select'
            }),
            'address': forms.Textarea(attrs={
                'class': 'form-control',
                'rows': 3,
                'placeholder': 'Enter your full address'
            }),
            'is_active': forms.CheckboxInput(attrs={
                'class': 'form-check-input'
            })
        }
    
    # Custom validation for phone number
    def clean_phone(self):
        phone = self.cleaned_data['phone']
        if len(phone) < 11:
            raise forms.ValidationError("Phone number must be at least 11 digits!")
        return phone
    
    # Email confirmation validation
    def clean(self):
        all_cleaned_data = super().clean()
        email = all_cleaned_data.get('email')
        confirm_email = all_cleaned_data.get('confirm_email')
        
        if email != confirm_email:
            raise forms.ValidationError("Email addresses don't match!")
        
        return all_cleaned_data
```

### üîß Widget Types for Bootstrap 5:
| Widget Type | Bootstrap Class | Usage |
|------------|-----------------|-------|
| TextInput | `form-control` | Text fields |
| EmailInput | `form-control` | Email fields |
| DateInput | `form-control` | Date picker |
| Select | `form-select` | Dropdown |
| RadioSelect | `form-check-input` | Radio buttons |
| CheckboxInput | `form-check-input` | Checkboxes |
| Textarea | `form-control` | Multi-line text |

---

## üéÆ Step 3: Create Views
### üìÑ `first_app/views.py`

```python
from django.shortcuts import render, redirect
from django.http import HttpResponse
from first_app.models import Student
from first_app.forms import StudentForm
from django.contrib import messages

def index(request):
    # SELECT * FROM Student ORDER BY first_name
    student_list = Student.objects.all().order_by('first_name')
    dictionary = {
        'title': 'All Students',
        'students': student_list
    }
    return render(request, 'first_app/index.html', context=dictionary)

def student_form(request):
    if request.method == 'POST':
        form = StudentForm(request.POST)
        
        if form.is_valid():
            # Save to database
            student = form.save(commit=False)  # Don't save yet
            # You can modify data here if needed
            # student.first_name = student.first_name.upper()
            student.save()  # Now save to database
            
            # Success message
            messages.success(request, f'Student {student.first_name} {student.last_name} added successfully!')
            
            # Redirect to index page
            return redirect('index')
        else:
            # Form has errors, it will show in template
            messages.error(request, 'Please correct the errors below.')
    else:
        # GET request - show empty form
        form = StudentForm()
    
    dictionary = {
        'form': form,
        'title': 'Add New Student'
    }
    return render(request, 'first_app/student_form.html', context=dictionary)

def edit_student(request, student_id):
    student = Student.objects.get(pk=student_id)
    
    if request.method == 'POST':
        form = StudentForm(request.POST, instance=student)  # Pass instance for editing
        
        if form.is_valid():
            form.save()
            messages.success(request, 'Student updated successfully!')
            return redirect('index')
    else:
        form = StudentForm(instance=student)  # Pre-fill form with existing data
    
    dictionary = {
        'form': form,
        'title': f'Edit Student: {student.first_name}'
    }
    return render(request, 'first_app/student_form.html', context=dictionary)
```

### üìä View Functions Breakdown:
- **`index()`**: Display all students
- **`student_form()`**: Add new student
- **`edit_student()`**: Update existing student

---

## üé® Step 4: Create Form Template
### üìÑ `template/first_app/student_form.html`

```html
<!doctype html>
<html lang="en">
{% load static %}
<head>
    <title>{{title}}</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- Bootstrap CSS v5.2.1 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>

<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h2 class="text-center">{{title}}</h2>
                    </div>
                    <div class="card-body">
                        
                        <!-- Show Messages -->
                        {% if messages %}
                            {% for message in messages %}
                                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                                    {{ message }}
                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                </div>
                            {% endfor %}
                        {% endif %}
                        
                        <!-- Form Errors -->
                        {% if form.non_field_errors %}
                            <div class="alert alert-danger">
                                {{ form.non_field_errors }}
                            </div>
                        {% endif %}
                        
                        <!-- Student Form -->
                        <form method="POST" action="" novalidate>
                            {% csrf_token %}
                            
                            <div class="row">
                                <!-- First Name -->
                                <div class="col-md-6 mb-3">
                                    <label for="{{ form.first_name.id_for_label }}" class="form-label">
                                        {{ form.first_name.label }}
                                        <span class="text-danger">*</span>
                                    </label>
                                    {{ form.first_name }}
                                    {% if form.first_name.errors %}
                                        <div class="text-danger small">{{ form.first_name.errors }}</div>
                                    {% endif %}
                                </div>
                                
                                <!-- Last Name -->
                                <div class="col-md-6 mb-3">
                                    <label for="{{ form.last_name.id_for_label }}" class="form-label">
                                        {{ form.last_name.label }}
                                        <span class="text-danger">*</span>
                                    </label>
                                    {{ form.last_name }}
                                    {% if form.last_name.errors %}
                                        <div class="text-danger small">{{ form.last_name.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <!-- Submit Buttons -->
                            <div class="d-flex justify-content-between">
                                <a href="{% url 'index' %}" class="btn btn-secondary">
                                    <i class="bi bi-arrow-left"></i> Back to List
                                </a>
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-save"></i> Save Student
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js"></script>
</body>
</html>
```

---

## üìã Step 5: Student List Template
### üìÑ `template/first_app/index.html`

```html
<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-12">
                <div class="card shadow">
                    <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
                        <h2>{{ title }}</h2>
                        <a href="{% url 'student_form' %}" class="btn btn-success">
                            <i class="bi bi-plus-circle"></i> Add New Student
                        </a>
                    </div>
                    <div class="card-body">
                        <!-- Student Table -->
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Phone</th>
                                        <th>Course</th>
                                        <th>Gender</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for student in students %}
                                    <tr>
                                        <td>{{ student.id }}</td>
                                        <td>{{ student.first_name }} {{ student.last_name }}</td>
                                        <td>{{ student.email }}</td>
                                        <td>{{ student.phone }}</td>
                                        <td>
                                            <span class="badge bg-primary">{{ student.get_course_display }}</span>
                                        </td>
                                        <td>{{ student.get_gender_display }}</td>
                                        <td>
                                            {% if student.is_active %}
                                                <span class="badge bg-success">Active</span>
                                            {% else %}
                                                <span class="badge bg-danger">Inactive</span>
                                            {% endif %}
                                        </td>
                                        <td>
                                            <a href="{% url 'edit_student' student.id %}" class="btn btn-sm btn-warning">
                                                <i class="bi bi-pencil"></i>
                                            </a>
                                            <button class="btn btn-sm btn-danger" onclick="confirmDelete({{ student.id }})">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    {% empty %}
                                    <tr>
                                        <td colspan="8" class="text-center">No students found</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
```

---

## üîó Step 6: URL Configuration
### üìÑ `first_app/urls.py`

```python
from django.urls import path
from first_app import views

urlpatterns = [
    path('', views.index, name='index'),
    path('add-student/', views.student_form, name='student_form'),
    path('edit-student/<int:student_id>/', views.edit_student, name='edit_student'),
]
```

---

## üóÑÔ∏è Step 7: Run Migrations

```bash
# Terminal Commands:
python manage.py makemigrations
python manage.py migrate
```

---

## ‚ú® Additional: Advanced Custom Validators
### üìÑ Enhanced `forms.py` with Custom Validators

```python
from django import forms
from first_app.models import Student
from django.core import validators
import re

# Custom validator function
def validate_name(value):
    if not re.match("^[a-zA-Z ]*$", value):
        raise forms.ValidationError("Name can only contain letters and spaces!")

def validate_age(value):
    from datetime import date
    today = date.today()
    age = today.year - value.year - ((today.month, today.day) < (value.month, value.day))
    if age < 18:
        raise forms.ValidationError("Student must be at least 18 years old!")
    
class StudentForm(forms.ModelForm):
    # Add custom validators to existing fields
    first_name = forms.CharField(
        validators=[validate_name, validators.MinLengthValidator(2)],
        widget=forms.TextInput(attrs={'class': 'form-control'})
    )
    
    class Meta:
        model = Student
        fields = '__all__'
        
    def clean_date_of_birth(self):
        dob = self.cleaned_data['date_of_birth']
        validate_age(dob)  # Call custom age validator
        return dob
```

---

## üìä Summary: Key Implementation Points

### üîë Core Components:
1. **Model** ‚Üí Define database structure with fields and choices
2. **ModelForm** ‚Üí Automatically generates form from model with validation
3. **Views** ‚Üí Handle GET (show form) and POST (save data) requests
4. **Template** ‚Üí Display form with Bootstrap 5 styling and error handling
5. **Validation** ‚Üí Built-in + custom validators for data integrity
6. **Messages** ‚Üí User feedback for successful/failed operations
7. **CRUD** ‚Üí Create, Read, Update operations implemented

### üîÑ Request Flow Diagram:
```
User fills form ‚Üí Submit ‚Üí View receives POST ‚Üí Form validates
    ‚Üì                                              ‚Üì
    ‚îî‚îÄ‚îÄ‚îÄ If valid ‚îÄ‚îÄ‚Üí Save to DB ‚Üí Success message ‚Üí Redirect to list
    ‚îî‚îÄ‚îÄ‚îÄ If invalid ‚Üí Show form with errors ‚Üí User corrects ‚Üí Resubmit
```

### üì¶ Key Features Implemented:
- ‚úÖ Bootstrap 5 responsive design
- ‚úÖ Form field validation (built-in & custom)
- ‚úÖ Email confirmation matching
- ‚úÖ Age verification (18+ years)
- ‚úÖ Phone number pattern validation
- ‚úÖ Success/Error messages
- ‚úÖ CSRF protection
- ‚úÖ Edit functionality with pre-filled forms
- ‚úÖ Responsive tables with actions

### üí° Best Practices:
- Use `commit=False` to modify data before saving
- Always validate on both client and server side
- Use Django messages framework for user feedback
- Implement proper URL naming for reverse lookups
- Keep forms DRY with ModelForm
- Apply Bootstrap classes via widgets

---

## üöÄ Quick Start Commands

```bash
# 1. Create Django project
django-admin startproject myproject

# 2. Create app
python manage.py startapp first_app

# 3. Add app to INSTALLED_APPS in settings.py
INSTALLED_APPS = [
    ...
    'first_app',
]

# 4. Create models, forms, views, templates

# 5. Make and run migrations
python manage.py makemigrations
python manage.py migrate

# 6. Create superuser
python manage.py createsuperuser

# 7. Run development server
python manage.py runserver
```

---

## üìù Notes
- Always use `{% csrf_token %}` in forms
- Use `novalidate` in form tag to disable HTML5 validation
- `get_FOO_display()` method for choice fields display
- Messages framework requires `django.contrib.messages` in INSTALLED_APPS
- Bootstrap 5 requires different classes than Bootstrap 4

---

### üéØ End Django ModelForm with Bootstrap 5 & Validation

---
